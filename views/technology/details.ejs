<% include ../partials/head.ejs %>
<main>
<% include ../partials/headercat.ejs %>
 <table>
    <tbody>
       <tr>
          <td>Name</td>
          <td><span><%= technology.name %></span></td>
        </tr>
        <tr>
          <td >Description:</td>
          <td><%= technology.description %></td>
        </tr>
        <tr>
          <td >Link to Docs:</td>
          <td><a href="<%= technology.documentation %>">Official Documentation</a></td>
        </tr>
        <tr>
          <td >See Example:</td>
          <td><a href="<%= technology.use_case %>"><%= technology.use_case %></a></td>
        </tr>
        <tr>
          <td >Category:</td>
          <td><a href="<%= `/categories/${technology.category_name}` %>"><%= technology.category_name.replace(/_/g, ' ') %></a></td>
        </tr>
    </tbody>
  </table>


<% if (user !== undefined) { %>
  <a href="<%= `/technologies/${technology.id}/edit` %>">
    <button type="submit" name="action">
      Edit this Technology
    </button>
  </a>
  <form action="favorites" method="POST">
    <input style="display:none" value="<%= technology.id %>" name="tech_id">
    <button type="submit" name="action">❤️
    </button>
  </form>
  <a href='../reviews/<%= technology.id %>'>
    <button>
      Review This Tech
    </button>
  </a>
<% } %>

<% if (!user) { %>
  <a href="<%= '/auth/login' %>">Login to edit this page or add to Favorites</a>
<% } %>

<p><a href="<%= '/technologies' %>">Back to Technologies List</a></p>
<p><a href="<%= '/categories' %>">Back to Categories</a></p>
<p><a href="<%= '/' %>">Back to Home Page</a></p>

<div>
  <ul>
  <% reviews.forEach((review) => { %>
          <li>
            <% if (!user) { %>
            <h3>Review by: <%= review.username %> - <a href="/auth/login">Login</a> to View Profile</h3>
            <% } %>

            <% if (user) { %>
            <h3>Review by: <%= review.username %> - <a href="/user/<%= review.user_id %>">View Profile</a></h3>
            <% } %>

            <p><%= review.title %> - <%= review.review_text %></p>
            <% if (user !== undefined) { %>
              <% if (user.username === review.username) { %>
            <form action="<%= `/technologies/${review.tech_id}/reviews/${review.id}?_method=DELETE` %>" method="POST">
            <button type="submit">Delete</button>
            </form>
            <a href="<%= `/technologies/${review.tech_id}/reviews/${review.id}/edit` %>">
            <button class="btn waves-effect waves-light" type="submit" name="action">Edit Review
            </button></a>
            <% } %>
            <% } %>
          </li>
          <% }) %>
  </ul>
</div>
</main>

